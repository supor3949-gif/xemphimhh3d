<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PHIM HH3D THUY·∫æT MINH </title>

  <style>
    :root{
      --bg:#0f172a;
      --panel:#0b1224;
      --panel2:#0b1020;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --border:rgba(255,255,255,.12);
      --border2:rgba(255,255,255,.06);
      --green:#22c55e;
      --greenDark:#062a16;
      --blue:#38bdf8;
      --orange:#fb923c;
      --shadow:0 12px 28px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 50% -10%, rgba(56,189,248,.10), transparent 60%),
        radial-gradient(1000px 500px at 20% 0%, rgba(34,197,94,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    a{color:inherit;text-decoration:none}

    /* ================= HEADER ================= */
    .siteHeader{
      position:sticky;
      top:0;
      z-index:50;
      background:rgba(2,6,23,.88);
      backdrop-filter: blur(12px);
      border-bottom:1px solid var(--border2);
    }
    .headerInner{
      max-width:1200px;
      margin:0 auto;
      padding:12px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:220px;
    }
    .logo{
      width:42px;height:42px;
      border-radius:12px;
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .brandText{display:flex;flex-direction:column;line-height:1.1}
    .brandName{font-size:18px;font-weight:900;letter-spacing:.3px}
    .brandTag{font-size:12px;color:var(--muted);margin-top:2px}

    .tools{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      flex:1;
    }
    .searchWrap{
      display:flex;align-items:center;gap:8px;
      background:rgba(11,16,32,.85);
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px 12px;
      min-width:320px;
      max-width:520px;
      width:44vw;
    }
    .search{
      background:none;border:none;outline:none;
      color:var(--text);
      width:100%;
      font-size:14px;
    }
    .select{
      background:rgba(11,16,32,.85);
      color:#cbd5e1;
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px 12px;
      outline:none;
      font-size:13px;
    }

    /* ================= LAYOUT ================= */
    .container{
      max-width:1200px;
      margin:0 auto;
      padding:14px 16px 30px;
    }
    .layout{
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:14px;
      align-items:start;
    }

    /* ================= PANELS ================= */
    .panel{
      background: rgba(17,24,39,.55);
      border:1px solid var(--border2);
      border-radius:16px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panelHeader{
      padding:12px 14px;
      border-bottom:1px solid var(--border2);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background: rgba(2,6,23,.55);
    }
    .panelTitle{
      display:flex;align-items:center;gap:10px;
      font-weight:900;
      letter-spacing:.2px;
    }
    .panelSub{
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }

    /* ================= TABS (TH·ª®) ================= */
    .tabs{
      display:flex;
      gap:8px;
      padding:12px 12px 10px;
      flex-wrap:wrap;
      position:relative;
      z-index:5;
    }
    .tab{
      flex:1 1 120px;
      min-width:110px;
      background: rgba(11,16,32,.75);
      border:1px solid var(--border2);
      border-radius:12px;
      padding:10px 8px;
      text-align:center;
      cursor:pointer;
      user-select:none;
      transition:.15s ease;
      pointer-events:auto;
    }
    .tab:hover{border-color:rgba(56,189,248,.35)}
    .tab .vn{font-weight:900;font-size:13px}
    .tab .en{color:var(--muted);font-size:11px;margin-top:3px}
    .tab.active{
      background: rgba(56,189,248,.18);
      border-color: rgba(56,189,248,.55);
      box-shadow: 0 10px 18px rgba(56,189,248,.10);
    }

    /* ================= GRID CARDS ================= */
    .grid{
      display:grid;
      grid-template-columns: repeat(6, 1fr);
      gap:12px;
      padding:12px;
    }
    .card{
      background: rgba(2,6,23,.55);
      border:1px solid var(--border2);
      border-radius:14px;
      padding:10px;
      cursor:pointer;
      transition:.12s ease;
      position:relative;
      min-height:220px;
    }
    .card:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.14);
    }

    .poster{
      width:100%;
      aspect-ratio:2/3;
      border-radius:12px;
      overflow:hidden;
      background: rgba(11,16,32,.85);
      position:relative;
    }
    .poster img{
      width:100%;height:100%;
      object-fit:cover;
      display:block;
    }
    .placeholder{
      position:absolute;inset:0;
      display:flex;align-items:center;justify-content:center;
      color:rgba(148,163,184,.95);
      font-weight:900;
      letter-spacing:.6px;
      font-size:12px;
    }

    /* badge tr√™n poster */
    .badgeTop{
      position:absolute;
      top:8px;left:8px;
      background: rgba(249,115,22,.95);
      color:#1f1204;
      font-size:11px;
      font-weight:900;
      padding:4px 6px;
      border-radius:10px;
      box-shadow: 0 10px 18px rgba(0,0,0,.35);
    }
    .badgeBottom{
      position:absolute;
      bottom:8px;left:8px;
      background: rgba(34,197,94,.90);
      color:#062a16;
      font-size:11px;
      font-weight:900;
      padding:4px 6px;
      border-radius:10px;
      box-shadow: 0 10px 18px rgba(0,0,0,.35);
    }

    .playOverlay{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(2,6,23,.55);
      opacity:0;
      transition:.16s ease;
    }
    .playBtn{
      border:none;
      background: var(--green);
      color: var(--greenDark);
      font-weight:900;
      padding:10px 14px;
      border-radius:14px;
      cursor:pointer;
      transform: translateY(6px);
      transition:.16s ease;
    }
    .card:hover .playOverlay{opacity:1}
    .card:hover .playBtn{transform: translateY(0)}

    .title{
      margin-top:8px;
      font-size:13px;
      font-weight:800;
      line-height:1.15;
      color:#e8eefb;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient: vertical;
      overflow:hidden;
      min-height:32px;
    }

    .card.updating{
      cursor:not-allowed;
      opacity:.8;
    }
    .card.updating:hover{transform:none;border-color:var(--border2)}
    .card.updating .playBtn{background:#334155;color:#cbd5e1}

    /* ================= RANKING ================= */
    .rankList{
      padding:10px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .rankItem{
      display:grid;
      grid-template-columns: 18px 44px 1fr;
      gap:10px;
      align-items:center;
      padding:10px;
      border-radius:14px;
      background: rgba(2,6,23,.45);
      border:1px solid var(--border2);
      cursor:pointer;
      transition:.12s ease;
    }
    .rankItem:hover{border-color:rgba(56,189,248,.35); transform:translateY(-1px)}
    .rankNum{
      color:#93c5fd;
      font-weight:900;
      text-align:center;
      font-size:13px;
    }
    .rankPoster{
      width:44px;height:56px;border-radius:10px;
      overflow:hidden;
      background: rgba(11,16,32,.85);
      border:1px solid rgba(255,255,255,.08);
      position:relative;
    }
    .rankPoster img{width:100%;height:100%;object-fit:cover;display:block}
    .rankPoster .placeholder{font-size:10px}
    .rankTitle{font-weight:900;font-size:13px;line-height:1.15}
    .rankMeta{color:var(--muted);font-size:11px;margin-top:3px}

    /* ================= MODAL ================= */
    .modalBack{
      position:fixed;inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:999;
      padding:16px;
    }
    .modal{
      width:min(520px, 96vw);
      background: rgba(2,6,23,.95);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      box-shadow: 0 18px 45px rgba(0,0,0,.55);
      overflow:hidden;
    }
    .modalTop{
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .modalTop b{font-size:14px}
    .closeBtn{
      border:none;
      background: rgba(255,255,255,.08);
      color:var(--text);
      border-radius:10px;
      padding:8px 10px;
      cursor:pointer;
    }
    .modalBody{
      padding:14px 16px 16px;
      color:#dbe7ff;
      font-size:13px;
      line-height:1.5;
    }
    .modalBody .muted{color:var(--muted);font-size:12px;margin-top:6px}

    /* ================= RESPONSIVE ================= */
    @media (max-width: 1100px){
      .layout{grid-template-columns: 1fr}
      .searchWrap{min-width:240px;width:100%}
      .grid{grid-template-columns: repeat(5, 1fr)}
    }
    @media (max-width: 860px){
      .grid{grid-template-columns: repeat(4, 1fr)}
    }
    @media (max-width: 560px){
      .grid{grid-template-columns: repeat(2, 1fr)}
      .headerInner{padding:10px 12px}
      .container{padding:12px}
      .searchWrap{min-width:unset}
    }
  </style>
</head>

<body>
  <!-- ================= HEADER ================= -->
  <header class="siteHeader">
    <div class="headerInner">
      <a class="brand" href="index.html" title="HH3D ‚Äì Kho phim ch·ªçn l·ªçc">
        <svg class="logo" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#22c55e"/>
              <stop offset="1" stop-color="#38bdf8"/>
            </linearGradient>
          </defs>
          <rect x="6" y="10" width="52" height="44" rx="12" fill="url(#g)" opacity="0.22"/>
          <path d="M18 22h28v20H18z" fill="none" stroke="url(#g)" stroke-width="3"/>
          <path d="M28 27l12 5-12 5z" fill="url(#g)"/>
        </svg>

        <div class="brandText">
          <div class="brandName">XEMPHIMHH3D</div>
          <div class="brandTag">xem phim gi√£i tr√≠ ngi√™m c·∫•m v√† kh√¥ng khuy·∫øn kh√≠ch c·ªù b·∫°c online d∆∞·ªõi m·ªçi h√¨nh th·ª©c
          </div>
        </div>
      </a>

      <div class="tools">
        <div class="searchWrap">
          <span>üîé</span>
          <input id="q" class="search" placeholder="T√¨m t√™n phim..." />
        </div>

        <select id="genre" class="select" title="Th·ªÉ lo·∫°i">
          <option value="">T·∫•t c·∫£ th·ªÉ lo·∫°i</option>
          <option value="tien-hiep">Ti√™n hi·ªáp</option>
          <option value="huyen-huyen">Huy·ªÅn huy·ªÖn</option>
          <option value="kiem-hiep">Ki·∫øm hi·ªáp</option>
          <option value="do-thi">ƒê√¥ th·ªã</option>
          <option value="hoat-hinh">Ho·∫°t h√¨nh</option>
        </select>

        <select id="sort" class="select" title="S·∫Øp x·∫øp">
          <option value="new">M·ªõi c·∫≠p nh·∫≠t</option>
          <option value="az">A ‚Üí Z</option>
          <option value="za">Z ‚Üí A</option>
          <option value="eps">Nhi·ªÅu t·∫≠p</option>
        </select>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="layout">
      <!-- ================= MAIN ================= -->
      <section class="panel">
        <div class="panelHeader">
          <div class="panelTitle">üìÖ L·ªãch Phim</div>
          <div class="panelSub" id="vnNow">H√¥m nay: ...</div>
        </div>

        <div class="tabs" id="tabs"></div>
        <div class="grid" id="grid"></div>
      </section>

      <!-- ================= RANKING ================= -->
      <aside class="panel">
        <div class="panelHeader">
          <div class="panelTitle">üèÜ B·∫£ng X·∫øp H·∫°ng</div>
          <div class="panelSub">Top 10 phim hay </div>
        </div>
        <div class="rankList" id="rankList"></div>
      </aside>
    </div>
  </div>

  <!-- ================= MODAL ================= -->
  <div class="modalBack" id="modalBack" role="dialog" aria-modal="true">
    <div class="modal">
      <div class="modalTop">
        <b id="modalTitle">ƒêang c·∫≠p nh·∫≠t</b>
        <button class="closeBtn" id="closeModal">ƒê√≥ng</button>
      </div>
      <div class="modalBody">
        <div id="modalMsg">Ch√∫ng t√¥i ƒëang c·ªë g·∫Øng c·∫≠p nh·∫≠t b·ªô phim n√†y.</div>
        <div class="muted" id="modalSub">B·∫°n quay l·∫°i sau nha.</div>
      </div>
    </div>
  </div>

  <script>
    /* ============================================================
      ‚úÖ INDEX CHU·∫®N ‚Äì FIX H·∫æT L·ªñI EM B√ÅO
      - Click tabs lu√¥n ƒÉn
      - Search b·ªè d·∫•u ti·∫øng Vi·ªát
      - Kh√¥ng c√≤n NO IMAGE r√°c: ch·ªó kh√¥ng c√≥ poster => ‚Äúƒêang c·∫≠p nh·∫≠t‚Äù
      - Click phim A lu√¥n ƒë√∫ng phim A
      - Top 10 click lu√¥n ƒë√∫ng phim
      - C√≥ file => m·ªü file (vd muc-than-ki.html)
      - Kh√¥ng file => modal "ƒëang c·∫≠p nh·∫≠t"
    ============================================================ */

    const VN_TZ = "Asia/Ho_Chi_Minh";

    /* ================== DATA THEO NG√ÄY ==================
      GHI CH√ö CHO EM:
      - title: T√äN PHIM (ƒë√£ ƒëi·ªÅn theo ·∫£nh em g·ª≠i)
      - poster: ·∫¢NH (EM T·ª∞ ƒêI·ªÄN) v√≠ d·ª•: "images/anh-tien-nghich.jpg"
      - episodes: D√íNG S·ªê T·∫¨P (vd "126/128")
      - badge: tem nh·ªè (vd "TM-VS", "4K TM-VS")
      - genre: th·ªÉ lo·∫°i (anh t·ª± ƒëo√°n, em ƒë·ªïi tho·∫£i m√°i)
      - file: FILE RI√äNG c·ªßa phim (vd "muc-than-ki.html"). Ch∆∞a c√≥ th√¨ ƒë·ªÉ ""
      - updating:true: √¥ tr·ªëng d·ª± ph√≤ng
    ===================================================== */

    const schedule = {
      mon: [
        { title:"T∆∞ V√¥ T√†", poster:"", episodes:"02/24", badge:"2D TM-VS", genre:"hoat-hinh", file:"" },
        { title:"Ngh·ªãch Thi√™n Ch√≠ T√¥n", poster:"", episodes:"484/580", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"V√µ Th∆∞·ª£ng Th·∫ßn ƒê·∫ø", poster:"", episodes:"565/632", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"ƒê·∫°i L·ª•c Linh V≈©", poster:"", episodes:"148/‚Ä¶", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Th·∫ßn T√†i Quy·ªÅn ƒê√¥", poster:"", episodes:"39/60", badge:"TM-VS", genre:"do-thi", file:"" },
        { title:"Th√¥n Ph·ªá Tinh Kh√¥ng", poster:"", episodes:"208/260", badge:"4K TM-VS", genre:"huyen-huyen", file:"" },
        { title:"L√£o T·ªï Luy·ªán Th·ªÉ", poster:"", episodes:"04/40", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Ti√™n ƒê·∫ø Tr·ªü V·ªÅ", poster:"", episodes:"16/16", badge:"4K TM-VS", genre:"tien-hiep", file:"" },
        { title:"Nh·∫•t Nh√¢n Chi H·∫°", poster:"", episodes:"04/12", badge:"2D TM-VS", genre:"hoat-hinh", file:"" },
        { title:"Nh·∫•t Nh√¢n Chi H·∫° (P2)", poster:"", episodes:"", badge:"2D TM-VS", genre:"hoat-hinh", file:"" },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
      ],

      tue: [
        { title:"T∆∞ V√¥ T√†", poster:"", episodes:"02/24", badge:"TM-VS", genre:"hoat-hinh", file:"" },
        { title:"Luy·ªán Kh√≠ M∆∞·ªùi V·∫°n NƒÉm", poster:"", episodes:"316/360", badge:"TM-VS", genre:"tien-hiep", file:"" },
        { title:"V·∫°n Gi·ªõi ƒê·ªôc T√¥n", poster:"", episodes:"404/498", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Gia Thi√™n", poster:"", episodes:"146/156", badge:"4K", genre:"tien-hiep", file:"" },
        { title:"Thi√™n T∆∞·ªõng", poster:"", episodes:"17/26", badge:"4K", genre:"kiem-hiep", file:"" },
        { title:"B√°ch Luy·ªán Th√†nh Th·∫ßn", poster:"", episodes:"113/‚Ä¶", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"Ti√™n Ki·∫øm K·ª≥ Hi·ªáp", poster:"", episodes:"07/26", badge:"4K", genre:"kiem-hiep", file:"" },
        { title:"Ng·∫°o Th·∫ø ƒêan Th·∫ßn", poster:"", episodes:"11/12", badge:"4K", genre:"tien-hiep", file:"" },
        { title:"V√µ H·ªìn ƒê·∫°i L·ª•c", poster:"", episodes:"42/48", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"V√µ Th·∫ßn Ch√∫a T·ªÉ", poster:"", episodes:"620/720", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Tuy·ªát Th·∫ø Chi·∫øn H·ªìn", poster:"", episodes:"160/‚Ä¶", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Ti√™n H√≥a Si√™u Ph√†m", poster:"", episodes:"04/16", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"Nh·∫•t Nh√¢n Chi H·∫°", poster:"", episodes:"", badge:"2D", genre:"hoat-hinh", file:"" },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
      ],

      wed: [
        { title:"T∆∞ V√¥ T√†", poster:"", episodes:"02/24", badge:"TM-VS", genre:"hoat-hinh", file:"" },
        { title:"Ki·∫øm Lai Ph·∫ßn 2", poster:"", episodes:"08/26", badge:"4K", genre:"kiem-hiep", file:"" },
        { title:"Th·∫ßn ·∫®n V∆∞∆°ng T·ªça", poster:"", episodes:"196/208", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"Huy·ªÅn Gi·ªõi Chi M√¥n", poster:"", episodes:"12/18", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"T·ª≠ Xuy√™n Ph·∫ßn 2", poster:"", episodes:"30/‚Ä¶", badge:"4K", genre:"kiem-hiep", file:"" },
        { title:"D·∫´n ƒêi·ªÉu C·ª±c Dƒ©‚Ä¶", poster:"", episodes:"08/08", badge:"2D", genre:"hoat-hinh", file:"" },
        { title:"ƒê√¥ Th·ªã C·ªï Ti√™n Y", poster:"", episodes:"146/150", badge:"TM-VS", genre:"do-thi", file:"" },
        { title:"B·∫Øt ƒê·∫ßu V·ªõi Ch√≠ T√¥n‚Ä¶", poster:"", episodes:"09/40", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
      ],

      thu: [
        { title:"T∆∞ V√¥ T√†", poster:"", episodes:"02/24", badge:"TM-VS", genre:"hoat-hinh", file:"" },
        { title:"Th·∫ø Gi·ªõi Ho√†n M·ªπ", poster:"", episodes:"253/286", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"S∆∞ Huynh A S∆∞ Huynh", poster:"", episodes:"126/143", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"ƒê·∫°i ƒê∆∞·ªùng Thua‚Ä¶", poster:"", episodes:"21/26", badge:"4K", genre:"kiem-hiep", file:"" },
        { title:"V√µ To√°i Tinh H√†", poster:"", episodes:"51/60", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Th·∫ßn T√†i Quy·ªÅn ƒê√¥", poster:"", episodes:"39/60", badge:"TM-VS", genre:"do-thi", file:"" },
        { title:"V≈© ƒê·ªông C√†n Kh√¥n", poster:"", episodes:"04/12", badge:"[End]", genre:"huyen-huyen", file:"" },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
      ],

      fri: [
        { title:"Vƒ©nh Sinh Ph·∫ßn 5", poster:"", episodes:"09/‚Ä¶", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"T∆∞ V√¥ T√†", poster:"", episodes:"02/24", badge:"2D TM-VS", genre:"hoat-hinh", file:"" },
        { title:"M·∫≠t M√£ S∆°n H·∫£i Kinh", poster:"", episodes:"07/13", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"ƒê·∫•u La ƒê·∫°i L·ª•c 2", poster:"", episodes:"138/156", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"Th·∫ßn M·ªô", poster:"", episodes:"70/85", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"ƒê·∫°i Ch√∫a T·ªÉ 3D", poster:"", episodes:"58/‚Ä¶", badge:"4K", genre:"tien-hiep", file:"" },
        { title:"Th·∫©m Kh√¥ng B·ªâ Ng·∫°n", poster:"", episodes:"05/‚Ä¶", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"Ngh·ªãch Thi√™n Ch√≠ T√¥n", poster:"", episodes:"484/580", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"V√µ Th∆∞·ª£ng Th·∫ßn ƒê·∫ø", poster:"", episodes:"565/632", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"ƒê·∫°i L·ª•c Linh V≈©", poster:"", episodes:"148/‚Ä¶", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Tam Tuy·ªÉn Lu√¢n H·ªìi", poster:"", episodes:"01-02", badge:"M·ªõi", genre:"huyen-huyen", file:"" },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
      ],

      sat: [
        { title:"ƒê·∫•u Ph√° Th∆∞∆°ng Khung", poster:"", episodes:"184/209", badge:"4K", genre:"huyen-huyen", file:"" },
        { title:"Tr·∫°ch Thi√™n K√Ω", poster:"", episodes:"01-03", badge:"4K M·ªõi", genre:"tien-hiep", file:"" },
        { title:"T∆∞ V√¥ T√†", poster:"", episodes:"02/24", badge:"2D TM-VS", genre:"hoat-hinh", file:"" },
        { title:"Ti√™n V√µ ƒê·∫ø T√¥n", poster:"", episodes:"152/182", badge:"4K", genre:"tien-hiep", file:"" },
        { title:"C·ª≠u D∆∞∆°ng V√µ Th·∫ßn", poster:"", episodes:"13/20", badge:"4K", genre:"kiem-hiep", file:"" },
        { title:"Luy·ªán Kh√≠ M∆∞·ªùi V·∫°n NƒÉm", poster:"", episodes:"316/360", badge:"TM-VS", genre:"tien-hiep", file:"" },
        { title:"V·∫°n Gi·ªõi ƒê·ªôc T√¥n", poster:"", episodes:"404/498", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Ph√†m Nh√¢n Tu Ti√™n‚Ä¶", poster:"", episodes:"176/176", badge:"4K Full", genre:"tien-hiep", file:"" },
        { title:"B·∫Øt ƒê·∫ßu V·ªõi Ch√≠ T√¥n‚Ä¶", poster:"", episodes:"09/40", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Nh·∫•t Nh√¢n Chi H·∫°", poster:"", episodes:"", badge:"2D TM-VS", genre:"hoat-hinh", file:"" },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
      ],

      sun: [
        { title:"T∆∞ V√¥ T√†", poster:"", episodes:"02/24", badge:"2D TM-VS", genre:"hoat-hinh", file:"" },
        { title:"Quang √Çm Chi Ngo·∫°i", poster:"", episodes:"07/26", badge:"4K TM-VS", genre:"kiem-hiep", file:"" },

        /* ‚úÖ M·ª§C TH·∫¶N K√ù - FILE RI√äNG (FIX L·ªñI G·ªåI FILE) */
        { title:"M·ª•c Th·∫ßn K√Ω", poster:"images/muc-than-ki.jpg", episodes:"68/78", badge:"4K TM-VS", genre:"kiem-hiep", file:"muc-than-ki.html" },

        { title:"Ti√™n Ngh·ªãch", poster:"images/anh-tien-nghich.jpg", episodes:"126/128", badge:"4K", genre:"tien-hiep", file:"tien-nghich.html" },
        { title:"V√µ To√°i Tinh H√†", poster:"", episodes:"5/60", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"Trung Qu·ªëc K·ª≥ ƒê√†m‚Ä¶", poster:"", episodes:"05/09", badge:"2D", genre:"hoat-hinh", file:"" },
        { title:"ƒê√¥ Th·ªã C·ªï Ti√™n Y", poster:"", episodes:"144/150", badge:"TM-VS", genre:"do-thi", file:"" },
        { title:"V√µ H·ªìn ƒê·∫°i L·ª•c", poster:"", episodes:"42/48", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"V√µ Th·∫ßn Ch√∫a T·ªÉ", poster:"", episodes:"620/720", badge:"TM-VS", genre:"huyen-huyen", file:"" },
        { title:"To√†n NƒÉng Cao Th·ªß", poster:"", episodes:"14/‚Ä¶", badge:"TM-VS", genre:"do-thi", file:"" },
        { title:"Ch·∫•m Dao Ca Ph·∫ßn 3", poster:"", episodes:"13/14", badge:"2D", genre:"hoat-hinh", file:"" },
        { title:"Nh·∫•t Nh√¢n Chi H·∫°", poster:"", episodes:"", badge:"2D", genre:"hoat-hinh", file:"" },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
        { title:"ƒêang c·∫≠p nh·∫≠t", poster:"", episodes:"", badge:"", genre:"", file:"", updating:true },
      ],
    };

    /* ================== TOP 10 ==================
      GHI CH√ö:
      - poster n·∫øu c√≥ th√¨ ƒëi·ªÅn ·∫£nh
      - file c√≥ th√¨ b·∫•m m·ªü file
      - kh√¥ng c√≥ file => modal c·∫≠p nh·∫≠t
    ============================================= */
    const ranking = [
      { title:"Ti√™n Ngh·ªãch", poster:"images/anh-tien-nghich.jpg", episodes:"126/128", badge:"4K", genre:"tien-hiep", file:"tien-nghich.html" },
      { title:"ƒê·∫•u Ph√° Th∆∞∆°ng Khung", poster:"", episodes:"184/209", badge:"4K", genre:"huyen-huyen", file:"" },
      { title:"M·ª•c Th·∫ßn K√Ω", poster:"images/muc-than-ki.jpg", episodes:"68/78", badge:"4K", genre:"kiem-hiep", file:"muc-than-ki.html" },
      { title:"Th·∫ø Gi·ªõi Ho√†n M·ªπ", poster:"", episodes:"253/286", badge:"4K", genre:"huyen-huyen", file:"" },
      { title:"Ph√†m Nh√¢n Tu Ti√™n (Full)", poster:"", episodes:"176/176", badge:"4K", genre:"tien-hiep", file:"" },
      { title:"ƒê·∫•u La ƒê·∫°i L·ª•c 2", poster:"", episodes:"138/156", badge:"4K", genre:"huyen-huyen", file:"" },
      { title:"Th√¥n Ph·ªá Tinh Kh√¥ng", poster:"", episodes:"208/260", badge:"4K", genre:"huyen-huyen", file:"" },
      { title:"Ki·∫øm Lai Ph·∫ßn 2", poster:"", episodes:"08/26", badge:"4K", genre:"kiem-hiep", file:"" },
      { title:"Gia Thi√™n", poster:"", episodes:"146/156", badge:"4K", genre:"tien-hiep", file:"" },
      { title:"Th·∫ßn ·∫®n V∆∞∆°ng T·ªça", poster:"", episodes:"196/208", badge:"4K", genre:"huyen-huyen", file:"" },
    ];

    const tabsConfig = [
      { key:"mon", vn:"Th·ª© 2", en:"Monday" },
      { key:"tue", vn:"Th·ª© 3", en:"Tuesday" },
      { key:"wed", vn:"Th·ª© 4", en:"Wednesday" },
      { key:"thu", vn:"Th·ª© 5", en:"Thursday" },
      { key:"fri", vn:"Th·ª© 6", en:"Friday" },
      { key:"sat", vn:"Th·ª© 7", en:"Saturday" },
      { key:"sun", vn:"Ch·ªß nh·∫≠t", en:"Sunday" },
    ];

    function getVNNow(){
      const now = new Date();
      const fmt = new Intl.DateTimeFormat("vi-VN", {
        timeZone: VN_TZ,
        weekday:"long",
        day:"2-digit",
        month:"2-digit",
        year:"numeric"
      });
      return fmt.format(now);
    }

    function getVNWeekdayKey(){
      const now = new Date();
      const vnWeekday = new Intl.DateTimeFormat("en-US", { timeZone: VN_TZ, weekday:"short" }).format(now);
      const map = { Mon:"mon", Tue:"tue", Wed:"wed", Thu:"thu", Fri:"fri", Sat:"sat", Sun:"sun" };
      return map[vnWeekday] || "sun";
    }

    /* ===== SEARCH B·ªé D·∫§U TI·∫æNG VI·ªÜT (FIX: l√∫c ƒë∆∞·ª£c l√∫c kh√¥ng) ===== */
    function stripVN(str=""){
      return str
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/ƒë/g,"d")
        .trim();
    }
    function normalize(s){ return stripVN(s||""); }

    function applyFilters(items){
      const q = normalize(document.getElementById("q").value);
      const g = document.getElementById("genre").value;
      const sort = document.getElementById("sort").value;

      let out = items.slice();

      if (q){
        out = out.filter(f => normalize(f.title).includes(q));
      }
      if (g){
        out = out.filter(f => (f.genre||"") === g);
      }

      if (sort === "az"){
        out.sort((a,b) => (a.title||"").localeCompare(b.title||"", "vi"));
      } else if (sort === "za"){
        out.sort((a,b) => (b.title||"").localeCompare(a.title||"", "vi"));
      } else if (sort === "eps"){
        const getNum = (x) => {
          const m = String(x||"").match(/(\d+)\s*\/\s*(\d+)/);
          if (!m) return 0;
          const cur = parseInt(m[1],10);
          const total = parseInt(m[2],10);
          return (total || cur || 0);
        };
        out.sort((a,b) => getNum(b.episodes) - getNum(a.episodes));
      }
      return out;
    }

    /* ===== MODAL ===== */
    function showModal(title, msg, sub){
      document.getElementById("modalTitle").textContent = title;
      document.getElementById("modalMsg").textContent = msg;
      document.getElementById("modalSub").textContent = sub;
      document.getElementById("modalBack").style.display = "flex";
    }
    function hideModal(){
      document.getElementById("modalBack").style.display = "none";
    }

    /* ===== OPEN FILM (FIX: b·∫•m phim A b√°o phim B) ===== */
    function openFilm(film){
      const isUpdating = !!film.updating || film.title === "ƒêang c·∫≠p nh·∫≠t";
      if (isUpdating){
        showModal("ƒêang c·∫≠p nh·∫≠t", "√î n√†y ch∆∞a c√≥ phim.", "B·∫°n quay l·∫°i sau nha.");
        return;
      }

      const f = (film.file || "").trim();
      if (f){
        location.href = f;
        return;
      }

      showModal(film.title, "Ch√∫ng t√¥i ƒëang c·ªë g·∫Øng c·∫≠p nh·∫≠t b·ªô phim n√†y.", "B·∫°n quay l·∫°i sau nha.");
    }

    function renderTabs(activeKey){
      const tabs = document.getElementById("tabs");
      tabs.innerHTML = "";
      tabsConfig.forEach(t => {
        const el = document.createElement("div");
        el.className = "tab" + (t.key === activeKey ? " active" : "");
        el.innerHTML = `<div class="vn">${t.vn}</div><div class="en">${t.en}</div>`;
        el.addEventListener("click", () => setActiveDay(t.key));
        tabs.appendChild(el);
      });
    }

    function renderGrid(dayKey){
      const grid = document.getElementById("grid");
      const raw = schedule[dayKey] || [];
      const items = applyFilters(raw);

      grid.innerHTML = "";
      items.forEach(film => {
        const isUpdating = !!film.updating || film.title === "ƒêang c·∫≠p nh·∫≠t";

        const card = document.createElement("div");
        card.className = "card" + (isUpdating ? " updating" : "");
        card.addEventListener("click", () => openFilm(film));

        const hasPoster = !!(film.poster && film.poster.trim());
        const posterHTML = hasPoster
          ? `<img src="${film.poster.trim()}" alt="${film.title}" loading="lazy">`
          : `<div class="placeholder">ƒêang c·∫≠p nh·∫≠t</div>`;

        const top = film.episodes ? `<div class="badgeTop">${film.episodes}</div>` : "";
        const bottom = film.badge ? `<div class="badgeBottom">${film.badge}</div>` : "";

        card.innerHTML = `
          <div class="poster">
            ${posterHTML}
            ${top}
            ${bottom}
            <div class="playOverlay">
              <button class="playBtn" type="button">${(film.file && film.file.trim()) ? "Xem ngay" : "Xem"}</button>
            </div>
          </div>
          <div class="title">${film.title}</div>
        `;
        grid.appendChild(card);
      });
    }

    function renderRanking(){
      const list = document.getElementById("rankList");
      list.innerHTML = "";

      ranking.forEach((film, idx) => {
        const item = document.createElement("div");
        item.className = "rankItem";
        item.addEventListener("click", () => openFilm(film));

        const hasPoster = !!(film.poster && film.poster.trim());
        const posterHTML = hasPoster
          ? `<img src="${film.poster.trim()}" alt="${film.title}" loading="lazy">`
          : `<div class="placeholder">Update</div>`;

        item.innerHTML = `
          <div class="rankNum">${idx + 1}</div>
          <div class="rankPoster">${posterHTML}</div>
          <div>
            <div class="rankTitle">${film.title}</div>
            <div class="rankMeta">
              ${film.episodes ? film.episodes + " ‚Ä¢ " : ""}
              ${film.badge ? film.badge + " ‚Ä¢ " : ""}
              ${film.genre || ""}
            </div>
          </div>
        `;
        list.appendChild(item);
      });
    }

    let ACTIVE_DAY = getVNWeekdayKey();
    function setActiveDay(dayKey){
      ACTIVE_DAY = dayKey;
      renderTabs(ACTIVE_DAY);
      renderGrid(ACTIVE_DAY);
    }

    /* ===== INIT ===== */
    document.getElementById("vnNow").textContent = "H√¥m nay: " + getVNNow();
    renderRanking();
    setActiveDay(ACTIVE_DAY);

    document.getElementById("q").addEventListener("input", () => renderGrid(ACTIVE_DAY));
    document.getElementById("genre").addEventListener("change", () => renderGrid(ACTIVE_DAY));
    document.getElementById("sort").addEventListener("change", () => renderGrid(ACTIVE_DAY));

    document.getElementById("closeModal").addEventListener("click", hideModal);
    document.getElementById("modalBack").addEventListener("click", (e) => {
      if (e.target.id === "modalBack") hideModal();
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") hideModal();
    });
  </script>
</body>
</html>
