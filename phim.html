<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Danh s√°ch phim | HH3D</title>
  <style>
    body{margin:0;font-family:Arial,sans-serif;background:#0f172a;color:#e5e7eb}
    header{background:#020617;padding:16px;text-align:center;font-size:22px;font-weight:800}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    a{color:inherit;text-decoration:none}
    .toprow{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .back{display:inline-block;margin:6px 0 14px;color:#22c55e}
    .hint{color:#94a3b8;font-size:13px}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:14px}
    .card{
      background:#020617;border-radius:12px;padding:12px;
      border:1px solid rgba(255,255,255,.06);
      cursor:pointer; transition:.15s transform;
    }
    .card:hover{transform:translateY(-2px)}
    .poster{
      width:100%; aspect-ratio:2/3; border-radius:10px;
      background:#0b1020; overflow:hidden;
      display:flex; align-items:center; justify-content:center;
      border:1px solid rgba(255,255,255,.06);
    }
    .poster img{width:100%;height:100%;object-fit:cover;display:block}
    .poster .ph{color:#94a3b8;font-weight:800;font-size:14px}
    .card h3{font-size:14px;margin:10px 0 0;line-height:1.2;text-align:center}

    .pager{display:flex;gap:8px;flex-wrap:wrap;margin:18px 0}
    .pager button{
      cursor:pointer;border:1px solid rgba(255,255,255,.12);
      background:#0b1020;color:#cbd5e1;padding:8px 10px;border-radius:10px;
      font-weight:800
    }
    .pager button.active{background:#22c55e;color:#062a16;border-color:transparent}
  </style>
</head>
<body>
  <header>üìÅ Danh s√°ch phim HH3D</header>

  <div class="container">
    <div class="toprow">
      <a class="back" href="index.html">‚Üê Quay v·ªÅ trang ch·ªß</a>
      <div class="hint" id="hint"></div>
    </div>

    <div id="grid" class="grid"></div>
    <div id="pager" class="pager"></div>
  </div>

  <script>
    const TOTAL_PAGES = 20;
    const PER_PAGE = 10;

    // ‚úÖ Danh s√°ch phim: b·∫°n ch·ªânh title/poster/episodesCount ·ªü ƒë√¢y.
    // poster d√πng ·∫£nh local: "images/ten-anh.jpg"
    // episodesCount l√† s·ªë t·∫≠p (vd Ti√™n Ngh·ªãch 126)
    const films = Array.from({ length: TOTAL_PAGES * PER_PAGE }, (_, i) => {
      const id = i + 1;
      return {
        id,
        title: `HH3D ${id}`,
        poster: "",          // ƒë·ªÉ tr·ªëng = hi·ªán n·ªÅn placeholder
        episodesCount: 0     // 0 = ch∆∞a set
      };
    });

    // ‚úÖ G√°n 3 phim th·∫≠t c·ªßa b·∫°n (ƒë·ªïi theo √Ω)
    films[0] = { id: 1, title: "Ti√™n Ngh·ªãch", poster: "images/anh-tien-nghich.jpg", episodesCount: 126 };
    films[1] = { id: 2, title: "ƒê·∫•u Ph√° Th∆∞∆°ng Khung", poster: "", episodesCount: 0 };
    films[2] = { id: 3, title: "Th·∫ø Gi·ªõi Ho√†n M·ªπ", poster: "", episodesCount: 0 };

    function getPageFromURL() {
      const p = parseInt(new URLSearchParams(location.search).get("page") || "1", 10);
      if (Number.isNaN(p) || p < 1) return 1;
      if (p > TOTAL_PAGES) return TOTAL_PAGES;
      return p;
    }

    function openFilm(film) {
      // M·ªü trang xem t·∫≠p (xem.html) v√† truy·ªÅn id + title
      // Trang xem s·∫Ω t·ª± t·∫°o danh s√°ch t·∫≠p theo episodesCount v√† c√≥ √¥ ƒë·ªÉ b·∫°n d√°n link
      const url = `xem.html?id=${encodeURIComponent(film.id)}&name=${encodeURIComponent(film.title)}&eps=${encodeURIComponent(film.episodesCount || 0)}`;
      location.href = url;
    }

    function render(page) {
      const grid = document.getElementById("grid");
      const pager = document.getElementById("pager");
      const hint = document.getElementById("hint");

      hint.textContent = `${TOTAL_PAGES} trang ‚Ä¢ ${PER_PAGE} phim / trang`;

      grid.innerHTML = "";
      pager.innerHTML = "";

      const start = (page - 1) * PER_PAGE;
      const pageFilms = films.slice(start, start + PER_PAGE);

      pageFilms.forEach(film => {
        const card = document.createElement("div");
        card.className = "card";
        card.onclick = () => openFilm(film);

        const poster = document.createElement("div");
        poster.className = "poster";

        if (film.poster) {
          const img = document.createElement("img");
          img.src = film.poster;
          img.alt = film.title;
          img.loading = "lazy";
          img.onerror = () => { poster.innerHTML = `<div class="ph">NO IMAGE</div>`; };
          poster.appendChild(img);
        } else {
          poster.innerHTML = `<div class="ph">NO IMAGE</div>`;
        }

        const h3 = document.createElement("h3");
        h3.textContent = film.title;

        card.appendChild(poster);
        card.appendChild(h3);
        grid.appendChild(card);
      });

      // pager 1..20
      for (let p = 1; p <= TOTAL_PAGES; p++) {
        const btn = document.createElement("button");
        btn.textContent = p;
        if (p === page) btn.classList.add("active");
        btn.onclick = () => location.href = `phim.html?page=${p}`;
        pager.appendChild(btn);
      }
    }

    render(getPageFromURL());
  </script>
</body>
</html>
