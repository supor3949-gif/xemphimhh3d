<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HH3D ‚Äì Kho phim ch·ªçn l·ªçc</title>

  <style>
    :root{
      --bg:#0f172a;
      --panel:#020617;
      --panel2:#0b1020;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --border:rgba(255,255,255,.12);
      --border2:rgba(255,255,255,.06);
      --green:#22c55e;
      --greenDark:#062a16;
    }

    body{margin:0;font-family:Arial,sans-serif;background:var(--bg);color:var(--text)}
    a{color:inherit;text-decoration:none}

    /* ===== HEADER STYLE ===== */
    .siteHeader{
      position:sticky;
      top:0;
      z-index:50;
      background:rgba(2,6,23,.9);
      backdrop-filter:blur(10px);
      border-bottom:1px solid var(--border2);
    }
    .headerInner{
      max-width:1100px;
      margin:0 auto;
      padding:12px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
    }
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:42px;height:42px}
    .brandText{display:flex;flex-direction:column;line-height:1.1}
    .brandName{font-size:18px;font-weight:900}
    .brandTag{font-size:12px;color:var(--muted);margin-top:2px}

    .tools{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .searchWrap{
      display:flex;align-items:center;gap:8px;
      background:var(--panel2);
      border:1px solid var(--border);
      border-radius:12px;
      padding:8px 10px;
    }
    .search{
      background:none;border:none;outline:none;
      color:var(--text);
      width:220px;
      max-width:60vw;
    }
    .select{
      background:var(--panel2);
      color:#cbd5e1;
      border:1px solid var(--border);
      border-radius:12px;
      padding:8px 10px;
      outline:none;
    }

    /* ===== PAGE ===== */
    .container{max-width:1100px;margin:0 auto;padding:18px}
    .toprow{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .back{display:inline-block;margin:6px 0 14px;color:var(--green)}
    .hint{color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:14px}
    .card{
      background:var(--panel);
      border-radius:12px;
      padding:12px;
      text-align:center;
      border:1px solid var(--border2);
      cursor:pointer;
      transition:transform .08s ease, border-color .12s ease;
    }
    .card:hover{border-color:rgba(34,197,94,.35);transform:translateY(-1px)}
    .poster{
      width:100%;
      aspect-ratio:2/3;
      border-radius:10px;
      background:var(--panel2);
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .poster img{width:100%;height:100%;object-fit:cover;display:block}
    .poster .noimg{
      position:absolute;
      color:var(--muted);
      font-weight:800;
      letter-spacing:.5px;
      font-size:12px;
    }
    .card h3{font-size:14px;margin:10px 0 0;line-height:1.2}

    .pager{display:flex;gap:8px;flex-wrap:wrap;margin:18px 0}
    .pager button{
      cursor:pointer;
      border:1px solid var(--border);
      background:var(--panel2);
      color:#cbd5e1;
      padding:8px 10px;
      border-radius:10px
    }
    .pager button.active{background:var(--green);color:var(--greenDark);border-color:transparent;font-weight:800}

    /* nh·ªè h∆°n mobile */
    @media (max-width:560px){
      .search{width:160px}
      .grid{grid-template-columns:repeat(auto-fill,minmax(160px,1fr))}
    }
  </style>
</head>

<body>

  <!-- ================= HEADER CH√çNH ================= -->
  <header class="siteHeader">
    <div class="headerInner">

      <!-- LOGO + T√äN (TR√ÅI) -->
      <a class="brand" href="phim.html">
        <!-- Logo SVG -->
        <svg class="logo" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#22c55e"/>
              <stop offset="1" stop-color="#60a5fa"/>
            </linearGradient>
          </defs>
          <rect x="6" y="10" width="52" height="44" rx="12" fill="url(#g)" opacity="0.18"/>
          <path d="M18 22h28v20H18z" fill="none" stroke="url(#g)" stroke-width="3"/>
          <path d="M28 27l12 5-12 5z" fill="url(#g)"/>
        </svg>

        <div class="brandText">
          <div class="brandName">HH3D</div>
          <div class="brandTag">Kho phim ch·ªçn l·ªçc</div>
        </div>
      </a>

      <!-- C√îNG C·ª§ (PH·∫¢I) -->
      <div class="tools">
        <div class="searchWrap">
          <span>üîç</span>
          <input id="q" class="search" placeholder="T√¨m t√™n phim..." />
        </div>

        <select id="genre" class="select" title="Th·ªÉ lo·∫°i">
          <option value="">T·∫•t c·∫£ th·ªÉ lo·∫°i</option>
          <option value="tien-hiep">Ti√™n hi·ªáp</option>
          <option value="huyen-huyen">Huy·ªÅn huy·ªÖn</option>
          <option value="kiem-hiep">Ki·∫øm hi·ªáp</option>
          <option value="hoat-hinh">Ho·∫°t h√¨nh</option>
        </select>

        <select id="sort" class="select" title="S·∫Øp x·∫øp">
          <option value="new">M·ªõi c·∫≠p nh·∫≠t</option>
          <option value="az">A ‚Üí Z</option>
          <option value="za">Z ‚Üí A</option>
          <option value="eps">Nhi·ªÅu t·∫≠p</option>
        </select>
      </div>

    </div>
  </header>
  <!-- =============== END HEADER ================= -->


  <div class="container">
    <div class="toprow">
      <a class="back" href="index.html">‚Üê Quay v·ªÅ trang ch·ªß</a>
      <div class="hint" id="hint">20 trang ‚Ä¢ 10 phim / trang</div>
    </div>

    <div id="grid" class="grid"></div>
    <div id="pager" class="pager"></div>
  </div>

  <script>
    const TOTAL_PAGES = 20;
    const PER_PAGE = 10;

    // ===== T·∫†O S·∫¥N 200 PHIM =====
    // L∆ØU √ù: Ch·ªâ ƒë·ªïi title + poster + slug + episodesCount + genre + page (n·∫øu c·∫ßn)
    const films = Array.from({ length: 200 }, (_, i) => ({
      id: i + 1,
      title: "",
      poster: "",
      slug: `film-${i + 1}`,
      episodesCount: 0,
      genre: "",     // v√≠ d·ª•: "tien-hiep"
      page: ""       // n·∫øu mu·ªën file ri√™ng: "muc-than-ki.html"
    }));

    // ====== SETUP PHIM (EM CH·ªà CH·ªàNH ·ªû ƒê√ÇY) ======
    // PHIM 1 ‚Äì TI√äN NGH·ªäCH
    films[0].title = "Ti√™n Ngh·ªãch";
    films[0].poster = "images/anh-tien-nghich.jpg";
    films[0].slug = "tien-nghich";
    films[0].episodesCount = 126;
    films[0].genre = "tien-hiep";
    // films[0].page = ""; // d√πng xem.html

    // PHIM 2
    films[1].title = "ƒê·∫•u Ph√° Th∆∞∆°ng Khung";
    films[1].poster = "images/dptk.jpg";
    films[1].slug = "dau-pha-thuong-khung";
    films[1].episodesCount = 100; // ch∆∞a c√≥ t·∫≠p th√¨ ƒë·ªÉ 0
    films[1].genre = "huyen-huyen";
    films[1].page = "";

    // PHIM 3
    films[2].title = "Th·∫ø Gi·ªõi Ho√†n M·ªπ";
    films[2].poster = "images/tghm.jpg";
    films[2].slug = "the-gioi-hoan-my";
    films[2].episodesCount = 100;
    films[2].genre = "huyen-huyen";

    // PHIM 4 ‚Äì M·ª§C TH·∫¶N K√ç (FILE RI√äNG)
    films[3].title = "M·ª•c Th·∫ßn K√≠";
    films[3].poster = "images/muc-than-ki.jpg";
    films[3].slug = "muc-than-ki";
    films[3].episodesCount = 68;
    films[3].genre = "kiem-hiep";
    films[3].page = "muc-than-ki.html"; // ‚úÖ file ri√™ng

    // ====== H·∫æT SETUP ======


    // ====== PAGE PARAMS ======
    function getPageFromURL(){
      const u = new URL(location.href);
      const p = parseInt(u.searchParams.get("page") || "1", 10);
      return Math.min(Math.max(p, 1), TOTAL_PAGES);
    }
    function goPage(p){
      const u = new URL(location.href);
      u.searchParams.set("page", String(p));
      location.href = u.toString();
    }

    // ====== FILTER / SORT (CH·ªà TR√äN TRANG HI·ªÜN T·∫†I) ======
    function normalize(s){ return (s || "").toLowerCase().trim(); }

    function applyFilters(items){
      const q = normalize(document.getElementById("q").value);
      const g = document.getElementById("genre").value;
      const sort = document.getElementById("sort").value;

      let out = items.slice();

      if (q){
        out = out.filter(f => normalize(f.title || ("HH3D " + f.id)).includes(q));
      }
      if (g){
        out = out.filter(f => (f.genre || "") === g);
      }

      // sort
      if (sort === "az"){
        out.sort((a,b) => (a.title||"").localeCompare(b.title||"", "vi"));
      } else if (sort === "za"){
        out.sort((a,b) => (b.title||"").localeCompare(a.title||"", "vi"));
      } else if (sort === "eps"){
        out.sort((a,b) => (b.episodesCount||0) - (a.episodesCount||0));
      } // "new" gi·ªØ nguy√™n th·ª© t·ª±

      return out;
    }

    // ====== RENDER ======
    function render(page){
      const grid = document.getElementById("grid");
      const pager = document.getElementById("pager");

      const start = (page - 1) * PER_PAGE;
      const pageItemsRaw = films.slice(start, start + PER_PAGE);
      const pageItems = applyFilters(pageItemsRaw);

      grid.innerHTML = "";
      pageItems.forEach(film => {
        const card = document.createElement("div");
        card.className = "card";

        card.onclick = () => {
          if (!film.episodesCount || film.episodesCount <= 0) {
            alert("Phim n√†y ch∆∞a c√≥ t·∫≠p. B·∫°n c·∫≠p nh·∫≠t episodesCount tr∆∞·ªõc nha!");
            return;
          }

          // N·∫øu phim c√≥ file ri√™ng
          if (film.page){
            location.href = film.page;
            return;
          }

          // M·∫∑c ƒë·ªãnh d√πng xem.html
          location.href = `xem.html?film=${encodeURIComponent(film.slug)}`;
        };

        const posterHTML = film.poster
          ? `<img src="${film.poster}" alt="${film.title}" loading="lazy">`
          : `<div class="noimg">NO IMAGE</div>`;

        card.innerHTML = `
          <div class="poster">${posterHTML}</div>
          <h3>${film.title || ("HH3D " + film.id)}</h3>
        `;
        grid.appendChild(card);
      });

      // pager
      pager.innerHTML = "";
      for (let p = 1; p <= TOTAL_PAGES; p++){
        const btn = document.createElement("button");
        btn.textContent = p;
        if (p === page) btn.classList.add("active");
        btn.onclick = () => goPage(p);
        pager.appendChild(btn);
      }
    }

    // rerender on search / filter / sort
    const pageNow = getPageFromURL();
    document.getElementById("q").addEventListener("input", () => render(pageNow));
    document.getElementById("genre").addEventListener("change", () => render(pageNow));
    document.getElementById("sort").addEventListener("change", () => render(pageNow));

    render(pageNow);
  </script>
</body>
</html>
