<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ĐẤU PHÁ THƯƠNG KHUNG | HH3D</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    body{margin:0;font-family:Arial,sans-serif;background:#0f172a;color:#e5e7eb}
    header{background:#020617;padding:16px;text-align:center;font-size:22px;font-weight:800}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    a{color:inherit;text-decoration:none}
    .back{display:inline-block;margin:6px 0 14px;color:#22c55e}
    .wrap{background:#020617;border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:14px}
    .title{font-size:26px;font-weight:900;margin:0}
    .sub{margin:6px 0 0;color:#94a3b8;font-size:13px}
    .player{margin-top:12px;border-radius:14px;overflow:hidden;background:#000}
    video{width:100%;height:auto;display:block}
    .episodes{margin-top:14px;background:#020617;border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:14px}
    .episodesTop{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .episodesTop .hint{color:#94a3b8;font-size:13px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:10px;margin-top:12px}
    .epbtn{cursor:pointer;border:1px solid rgba(255,255,255,.12);background:#0b1020;color:#cbd5e1;padding:10px;border-radius:12px;font-weight:800}
    .epbtn.active{background:#22c55e;color:#062a16;border-color:transparent}
  </style>
</head>

<body>
  <header>HH3D KHO PHIM CHỌN LỌC</header>

  <div class="container">
    <a class="back" href="phim.html">← Quay về danh sách phim</a>

    <div class="wrap">
      <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>
          <h1 class="title" id="filmTitle">ĐẤU PHÁ THƯƠNG KHUNG </h1>
          <div class="sub" id="filmSub">Chọn tập để xem</div>
        </div>
        <div class="sub">HLS (m3u8)</div>
      </div>

      <div class="player">
        <video id="video" controls playsinline></video>
      </div>
    </div>

    <div class="episodes">
      <div class="episodesTop">
        <div style="font-weight:900">Danh sách tập</div>
        <div class="hint"><span id="totalEp">0</span> tập</div>
      </div>
      <div id="epGrid" class="grid"></div>
    </div>
  </div>

  <script>
    // ====== CẤU HÌNH PHIM ======
    const FILM_TITLE = "ĐÁU PHÁ THƯƠNG KHUNG";

    // ====== 68 TẬP: EM DÁN LINK M3U8 VÀO "" ======
    const EPISODES = [
      "", // Tập 01
      "", // Tập 02
      "", // Tập 03
      "", // Tập 04
      "", // Tập 05
      "", // Tập 06
      "", // Tập 07
      "", // Tập 08
      "", // Tập 09
      "", // Tập 10
      "", // Tập 11
      "", // Tập 12
      "", // Tập 13
      "", // Tập 14
      "", // Tập 15
      "", // Tập 16
      "", // Tập 17
      "", // Tập 18
      "", // Tập 19
      "", // Tập 20
      "", // Tập 21
      "", // Tập 22
      "", // Tập 23
      "", // Tập 24
      "", // Tập 25
      "", // Tập 26
      "", // Tập 27
      "", // Tập 28
      "", // Tập 29
      "", // Tập 30
      "", // Tập 31
      "", // Tập 32
      "", // Tập 33
      "", // Tập 34
      "", // Tập 35
      "", // Tập 36
      "", // Tập 37
      "", // Tập 38
      "", // Tập 39
      "", // Tập 40
      "", // Tập 41
      "", // Tập 42
      "", // Tập 43
      "", // Tập 44
      "", // Tập 45
      "", // Tập 46
      "", // Tập 47
      "", // Tập 48
      "", // Tập 49
      "", // Tập 50
      "", // Tập 51
      "", // Tập 52
      "", // Tập 53
      "", // Tập 54
      "", // Tập 55
      "", // Tập 56
      "", // Tập 57
      "", // Tập 58
      "", // Tập 59
      "", // Tập 60
      "", // Tập 61
      "", // Tập 62
      "", // Tập 63
      "", // Tập 64
      "", // Tập 65
      "", // Tập 66
      "", // Tập 67
      "", // Tập 68
    ];

    // ====== PLAYER (HLS) ======
    const video = document.getElementById("video");
    let hls = null;

    function playM3U8(url){
      if (!url) {
        alert("Tập này chưa có link m3u8. Em dán link vào EPISODES trước nha!");
        return;
      }

      // dọn player cũ
      if (hls) { hls.destroy(); hls = null; }
      video.pause();
      video.removeAttribute("src");
      video.load();

      if (video.canPlayType("application/vnd.apple.mpegurl")) {
        video.src = url; // Safari / iOS
      } else if (window.Hls) {
        hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
      } else {
        alert("Trình duyệt không hỗ trợ HLS.");
      }
      video.play().catch(()=>{});
    }

    // ====== UI ======
    document.getElementById("filmTitle").textContent = FILM_TITLE;
    document.getElementById("totalEp").textContent = EPISODES.length;

    const epGrid = document.getElementById("epGrid");

    function renderEpisodes(activeIndex = 0){
      epGrid.innerHTML = "";
      EPISODES.forEach((_, i) => {
        const btn = document.createElement("button");
        btn.className = "epbtn" + (i === activeIndex ? " active" : "");
        btn.textContent = "Tập " + String(i+1).padStart(2,"0");
        btn.onclick = () => {
          document.querySelectorAll(".epbtn").forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          document.getElementById("filmSub").textContent = `${FILM_TITLE} • Tập ${String(i+1).padStart(2,"0")}`;
          playM3U8(EPISODES[i]);
        };
        epGrid.appendChild(btn);
      });
      document.getElementById("filmSub").textContent = `${FILM_TITLE} • Tập ${String(activeIndex+1).padStart(2,"0")}`;
    }

    renderEpisodes(0);
    // Nếu em muốn tự chạy tập 1 khi có link:
    // playM3U8(EPISODES[0]);
  </script>
</body>
</html>
