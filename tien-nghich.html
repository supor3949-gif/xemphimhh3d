<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ti√™n Ngh·ªãch ‚Äì HH3D</title>

  <!-- HLS.js ƒë·ªÉ ph√°t m3u8 tr√™n ƒëa s·ªë tr√¨nh duy·ªát -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.18/dist/hls.min.js"></script>

  <style>
    :root{
      --bg:#0f172a;
      --panel:rgba(17,24,39,.55);
      --panel2:rgba(2,6,23,.55);
      --panel3:rgba(11,16,32,.85);
      --text:#e5e7eb;
      --muted:#94a3b8;
      --border:rgba(255,255,255,.12);
      --border2:rgba(255,255,255,.06);
      --green:#22c55e;
      --greenDark:#062a16;
      --blue:#38bdf8;
      --shadow:0 12px 28px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Arial,sans-serif;
      background:
        radial-gradient(1200px 600px at 50% -10%, rgba(56,189,248,.10), transparent 60%),
        radial-gradient(1000px 500px at 20% 0%, rgba(34,197,94,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    a{color:inherit;text-decoration:none}

    /* ===== Header (gi·ªëng index) ===== */
    .siteHeader{
      position:sticky;top:0;z-index:50;
      background:rgba(2,6,23,.88);
      backdrop-filter: blur(12px);
      border-bottom:1px solid var(--border2);
    }
    .headerInner{
      max-width:1200px;margin:0 auto;
      padding:12px 16px;
      display:flex;align-items:center;justify-content:space-between;
      gap:14px;flex-wrap:wrap;
    }
    .brand{display:flex;align-items:center;gap:10px;min-width:220px}
    .logo{width:42px;height:42px;border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.35)}
    .brandText{display:flex;flex-direction:column;line-height:1.1}
    .brandName{font-size:18px;font-weight:900;letter-spacing:.3px}
    .brandTag{font-size:12px;color:var(--muted);margin-top:2px}

    .tools{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:flex-end;flex:1}
    .pill{
      background:rgba(11,16,32,.85);
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px 12px;
      font-size:13px;
      color:#cbd5e1;
    }

    /* ===== Layout ===== */
    .container{max-width:1200px;margin:0 auto;padding:14px 16px 30px}
    .panel{
      background:var(--panel);
      border:1px solid var(--border2);
      border-radius:16px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .panelHeader{
      padding:12px 14px;
      border-bottom:1px solid var(--border2);
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      background:rgba(2,6,23,.55);
    }
    .panelTitle{display:flex;align-items:center;gap:10px;font-weight:900}
    .panelSub{color:var(--muted);font-size:12px;white-space:nowrap}

    .movieRow{
      display:grid;
      grid-template-columns: 260px 1fr;
      gap:14px;
      padding:14px;
      align-items:start;
    }

    .posterBox{
      background:rgba(2,6,23,.45);
      border:1px solid var(--border2);
      border-radius:16px;
      padding:10px;
    }
    .poster{
      width:100%;
      aspect-ratio:2/3;
      border-radius:14px;
      overflow:hidden;
      background:rgba(11,16,32,.85);
      position:relative;
    }
    .poster img{width:100%;height:100%;object-fit:cover;display:block}
    .noimg{
      position:absolute;inset:0;
      display:flex;align-items:center;justify-content:center;
      color:rgba(148,163,184,.95);
      font-weight:900;letter-spacing:.6px;font-size:12px;
    }
    .metaBox{padding:10px 4px 0}
    .h1{font-size:18px;font-weight:900;margin:0 0 6px}
    .meta{color:var(--muted);font-size:12px;line-height:1.4}
    .btnRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .btn{
      border:none;
      background:rgba(56,189,248,.18);
      border:1px solid rgba(56,189,248,.35);
      color:#dbeafe;
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:800;
    }
    .btn.green{
      background:var(--green);
      color:var(--greenDark);
      border:1px solid rgba(34,197,94,.55);
    }

    /* ===== Player box ===== */
    .playerWrap{
      background:rgba(2,6,23,.45);
      border:1px solid var(--border2);
      border-radius:16px;
      overflow:hidden;
    }
    .playerTop{
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid var(--border2);
      background:rgba(2,6,23,.55);
    }
    .playerTitle{font-weight:900}
    .playerHint{color:var(--muted);font-size:12px}
    .playerBody{padding:12px 14px}
    video{
      width:100%;
      border-radius:14px;
      background:#000;
      outline:none;
    }
    .iframeBox{
      width:100%;
      aspect-ratio:16/9;
      border-radius:14px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.08);
      background:#000;
      display:none;
    }
    .iframeBox iframe{
      width:100%;
      height:100%;
      border:0;
      display:block;
    }
    .playerNote{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      line-height:1.45;
    }

    /* ===== Episode tools ===== */
    .epTools{
      display:flex;gap:10px;flex-wrap:wrap;
      padding:0 14px 14px;
    }
    .searchWrap{
      display:flex;align-items:center;gap:8px;
      background:var(--panel3);
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px 12px;
      flex:1;
      min-width:240px;
    }
    .searchWrap input{
      width:100%;
      background:none;border:none;outline:none;
      color:var(--text);
      font-size:14px;
    }
    .select{
      background:var(--panel3);
      color:#cbd5e1;
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px 12px;
      outline:none;
      font-size:13px;
    }

    /* ===== Episode grid ===== */
    .epGrid{
      display:grid;
      grid-template-columns: repeat(10, 1fr);
      gap:10px;
      padding:0 14px 14px;
    }
    .epBtn{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(2,6,23,.55);
      color:#e5e7eb;
      padding:10px 0;
      border-radius:14px;
      cursor:pointer;
      font-weight:900;
      transition:.12s ease;
      position:relative;
    }
    .epBtn:hover{transform:translateY(-1px);border-color:rgba(56,189,248,.35)}
    .epBtn.done{
      border-color: rgba(34,197,94,.55);
      box-shadow: 0 10px 18px rgba(34,197,94,.08);
    }
    .epBtn.lock{
      cursor:not-allowed;
      opacity:.55;
    }
    .epBtn small{
      position:absolute;
      bottom:6px;left:0;right:0;
      font-size:10px;
      color:var(--muted);
      font-weight:700;
    }

    /* ===== Modal ===== */
    .modalBack{
      position:fixed;inset:0;
      background: rgba(0,0,0,.55);
      display:none;align-items:center;justify-content:center;
      z-index:999;padding:16px;
    }
    .modal{
      width:min(520px, 96vw);
      background: rgba(2,6,23,.95);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      box-shadow: 0 18px 45px rgba(0,0,0,.55);
      overflow:hidden;
    }
    .modalTop{
      padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .closeBtn{
      border:none;
      background: rgba(255,255,255,.08);
      color:var(--text);
      border-radius:10px;
      padding:8px 10px;
      cursor:pointer;
    }
    .modalBody{padding:14px 16px 16px;color:#dbe7ff;font-size:13px;line-height:1.5}
    .muted{color:var(--muted);font-size:12px;margin-top:6px}

    /* ===== Footer note ===== */
    .footerNote{
      max-width:1200px;
      margin:14px auto 0;
      padding:12px 16px;
      color:rgba(148,163,184,.92);
      font-size:11.5px;
      line-height:1.55;
      border-top:1px solid rgba(255,255,255,.06);
    }

    @media (max-width: 1100px){
      .movieRow{grid-template-columns: 220px 1fr}
      .epGrid{grid-template-columns: repeat(8, 1fr)}
    }
    @media (max-width: 860px){
      .movieRow{grid-template-columns: 1fr}
      .epGrid{grid-template-columns: repeat(6, 1fr)}
    }
    @media (max-width: 560px){
      .epGrid{grid-template-columns: repeat(4, 1fr)}
    }
  </style>
</head>

<body>
  <header class="siteHeader">
    <div class="headerInner">
      <a class="brand" href="index.html" title="V·ªÅ trang ch·ªß">
        <svg class="logo" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#22c55e"/>
              <stop offset="1" stop-color="#38bdf8"/>
            </linearGradient>
          </defs>
          <rect x="6" y="10" width="52" height="44" rx="12" fill="url(#g)" opacity="0.22"/>
          <path d="M18 22h28v20H18z" fill="none" stroke="url(#g)" stroke-width="3"/>
          <path d="M28 27l12 5-12 5z" fill="url(#g)"/>
        </svg>
        <div class="brandText">
          <div class="brandName">XEMPHIMHH3D</div>
          <div class="brandTag">xem phim gi·∫£i tr√≠ ‚Ä¢ nghi√™m c·∫•m & kh√¥ng khuy·∫øn kh√≠ch c·ªù b·∫°c online d∆∞·ªõi m·ªçi h√¨nh th·ª©c</div>
        </div>
      </a>

      <div class="tools">
        <div class="pill" id="movieInfo">Ti√™n Ngh·ªãch ‚Ä¢ 128 t·∫≠p</div>
      </div>
    </div>
  </header>

  <div class="container">
    <section class="panel">
      <div class="panelHeader">
        <div class="panelTitle">üé¨ Ti√™n Ngh·ªãch</div>
        <div class="panelSub" id="subInfo">C·∫≠p nh·∫≠t: t·∫≠p 125/128</div>
      </div>

      <div class="movieRow">
        <div class="posterBox">
          <div class="poster">
            <!-- ‚úÖ POSTER: ƒë·ªïi ƒë∆∞·ªùng d·∫´n ·∫£nh ·ªü ƒë√¢y -->
            <img src="images/anh-tien-nghich.jpg" alt="Ti√™n Ngh·ªãch"
              onerror="this.remove(); document.getElementById('noimg').style.display='flex';">
            <div class="noimg" id="noimg" style="display:none">NO IMAGE</div>
          </div>
          <div class="metaBox">
            <p class="h1">Ti√™n Ngh·ªãch</p>
            <div class="meta">
              <div>Th·ªÉ lo·∫°i: <b>Ti√™n hi·ªáp</b></div>
              <div>T·ªïng t·∫≠p: <b>128</b></div>
            </div>
            <div class="btnRow">
              <button class="btn" onclick="location.href='index.html'">‚Üê V·ªÅ trang ch·ªß</button>
              <button class="btn green" onclick="scrollToEpisodes()">Xem danh s√°ch t·∫≠p</button>
            </div>
          </div>
        </div>

        <div>
          <!-- PLAYER -->
          <div class="playerWrap">
            <div class="playerTop">
              <div class="playerTitle" id="nowPlaying">Ch·ªçn t·∫≠p ƒë·ªÉ xem</div>
              <div class="playerHint" id="playerType">H·ªó tr·ª£ m3u8 / player</div>
            </div>
            <div class="playerBody">
              <video id="video" controls playsinline></video>

              <!-- player d·∫°ng iframe (n·∫øu link kh√¥ng ph·∫£i m3u8) -->
              <div class="iframeBox" id="iframeBox">
                <iframe id="iframe" allow="autoplay; encrypted-media; fullscreen" allowfullscreen></iframe>
              </div>

              <div class="playerNote">
                ‚úÖ N·∫øu link b·ªã ch·∫∑n (CORS/Referer/token) th√¨ c√≥ th·ªÉ kh√¥ng ph√°t ƒë∆∞·ª£c d√π code ƒë√∫ng.
              </div>
            </div>
          </div>

          <div class="meta" style="padding:10px 4px 10px">
            ‚úÖ T·∫≠p n√†o c√≥ link s·∫Ω c√≥ vi·ªÅn xanh. T·∫≠p ch∆∞a c√≥ link s·∫Ω hi·ªán ‚Äúƒëang c·∫≠p nh·∫≠t‚Äù.
          </div>

          <div class="epTools">
            <div class="searchWrap">
              <span>üîé</span>
              <input id="epSearch" placeholder="Nh·∫≠p s·ªë t·∫≠p‚Ä¶ (vd: 67)" inputmode="numeric" />
            </div>

            <select id="epSort" class="select" title="S·∫Øp x·∫øp">
              <option value="asc">T·∫≠p tƒÉng d·∫ßn</option>
              <option value="desc">T·∫≠p gi·∫£m d·∫ßn</option>
              <option value="done">C√≥ link tr∆∞·ªõc</option>
            </select>
          </div>

          <div class="epGrid" id="epGrid"></div>
        </div>
      </div>
    </section>

    <div class="footerNote">
      L∆∞u √Ω: Ch√∫ng t√¥i t·ª´ ch·ªëi m·ªçi tr√°ch nhi·ªám li√™n quan ƒë·∫øn n·ªôi dung hi·ªÉn th·ªã/t·ªìn t·∫°i tr√™n trang.
      T·∫•t c·∫£ video v√† d·ªØ li·ªáu t·∫°i ƒë√¢y ƒë·ªÅu ƒë∆∞·ª£c t·ªïng h·ª£p t·ª´ c√°c ngu·ªìn ph·ªï bi·∫øn tr√™n Internet, v√† kh√¥ng thu·ªôc quy·ªÅn s·ªü h·ªØu hay ki·ªÉm so√°t c·ªßa ch√∫ng t√¥i.
      Ch√∫ng t√¥i kh√¥ng cung c·∫•p d·ªãch v·ª• ph√°t tr·ª±c tuy·∫øn ch√≠nh th·ª©c. N·∫øu b·∫°n cho r·∫±ng quy·ªÅn l·ª£i c·ªßa m√¨nh b·ªã ·∫£nh h∆∞·ªüng, vui l√≤ng li√™n h·ªá ngay cho ch√∫ng t√¥i
      s·∫Ω x·ª≠ l√Ω v√† g·ª° b·ªè n·ªôi dung vi ph·∫°m k·ªãp th·ªùi. Xin c·∫£m ∆°n s·ª± th√¥ng c·∫£m v√† h·ª£p t√°c c·ªßa b·∫°n.
      V√† xem phim gi·∫£i tr√≠, nghi√™m c·∫•m v√† kh√¥ng khuy·∫øn kh√≠ch c·ªù b·∫°c online d∆∞·ªõi m·ªçi h√¨nh th·ª©c.
    </div>
  </div>

  <!-- Modal -->
  <div class="modalBack" id="modalBack" role="dialog" aria-modal="true">
    <div class="modal">
      <div class="modalTop">
        <b id="modalTitle">ƒêang c·∫≠p nh·∫≠t</b>
        <button class="closeBtn" id="closeModal">ƒê√≥ng</button>
      </div>
      <div class="modalBody">
        <div id="modalMsg">T·∫≠p n√†y ch∆∞a c√≥ link.</div>
        <div class="muted" id="modalSub">B·∫°n quay l·∫°i sau nha.</div>
      </div>
    </div>
  </div>

  <script>
    /* =========================================================
      ‚úÖ C·∫§U H√åNH PHIM: Ti√™n Ngh·ªãch
      - TOTAL_EP: t·ªïng t·∫≠p
      - UPDATED_EP: t·∫≠p m·ªõi nh·∫•t ƒëang c√≥ link
      - EP_URLS: map { s·ªë_t·∫≠p: "link m3u8 ho·∫∑c link player" }
         -> Em ch·ªâ c·∫ßn th√™m nh∆∞: EP_URLS[126] = "https://....m3u8";
    ========================================================= */
    const MOVIE_TITLE = "Ti√™n Ngh·ªãch";
    const TOTAL_EP = 128;
    const UPDATED_EP = 125; // ‚úÖ em g·ª≠i t·ªõi t·∫≠p 125

    // ‚úÖ LINK T·∫¨P (ƒë√£ ƒëi·ªÅn s·∫µn 1‚Üí125)
    const EP_URLS = {};
    EP_URLS[1]  = "https://s4.phim1280.tv/20240902/nkndLrz4/index.m3u8";
    EP_URLS[2]  = "https://s4.phim1280.tv/20240902/81WUV6fg/index.m3u8";
    EP_URLS[3]  = "https://s4.phim1280.tv/20240902/vnt5dWem/index.m3u8";
    EP_URLS[4]  = "https://s4.phim1280.tv/20240902/P9JDqwRd/index.m3u8";
    EP_URLS[5]  = "https://s4.phim1280.tv/20240902/qxtZu37s/index.m3u8";
    EP_URLS[6]  = "https://s4.phim1280.tv/20240902/9GBHeFgZ/index.m3u8";
    EP_URLS[7]  = "https://s4.phim1280.tv/20240902/e1ZUCMpW/index.m3u8";
    EP_URLS[8]  = "https://s4.phim1280.tv/20240902/tZXy5eVa/index.m3u8";
    EP_URLS[9]  = "https://s4.phim1280.tv/20240902/oz4kRHxo/index.m3u8";
    EP_URLS[10] = "https://s4.phim1280.tv/20240902/gpI609pJ/index.m3u8";
    EP_URLS[11] = "https://s4.phim1280.tv/20240902/xUrVd8wF/index.m3u8";
    EP_URLS[12] = "https://s4.phim1280.tv/20240902/Csf5y5ea/index.m3u8";
    EP_URLS[13] = "https://s4.phim1280.tv/20240902/dpGukr3a/index.m3u8";
    EP_URLS[14] = "https://s4.phim1280.tv/20240902/raqbZK8W/index.m3u8";
    EP_URLS[15] = "https://s4.phim1280.tv/20240902/p0dbdtCV/index.m3u8";
    EP_URLS[16] = "https://s4.phim1280.tv/20240902/DAJ1aPht/index.m3u8";
    EP_URLS[17] = "https://s4.phim1280.tv/20240902/32HJMyxH/index.m3u8";
    EP_URLS[18] = "https://s4.phim1280.tv/20240902/dwHrM6X9/index.m3u8";
    EP_URLS[19] = "https://s4.phim1280.tv/20240902/lIkT49nH/index.m3u8";
    EP_URLS[20] = "https://s4.phim1280.tv/20240902/I7xOOHGv/index.m3u8";
    EP_URLS[21] = "https://s4.phim1280.tv/20240902/ZHwwFGpT/index.m3u8";
    EP_URLS[22] = "https://s4.phim1280.tv/20240902/Y6YFZf1I/index.m3u8";
    EP_URLS[23] = "https://s4.phim1280.tv/20240902/osEqerpC/index.m3u8";
    EP_URLS[24] = "https://s4.phim1280.tv/20240902/IszCdMJJ/index.m3u8";
    EP_URLS[25] = "https://s4.phim1280.tv/20240902/UcgaQIy8/index.m3u8";
    EP_URLS[26] = "https://s4.phim1280.tv/20240902/b6vOL0z2/index.m3u8";
    EP_URLS[27] = "https://s4.phim1280.tv/20240902/Lld9jJhv/index.m3u8";
    EP_URLS[28] = "https://s4.phim1280.tv/20240902/evZDqztr/index.m3u8";
    EP_URLS[29] = "https://s4.phim1280.tv/20240902/ii77Y5Ur/index.m3u8";
    EP_URLS[30] = "https://s4.phim1280.tv/20240902/RFGt0l9A/index.m3u8";
    EP_URLS[31] = "https://s4.phim1280.tv/20240902/udjaoPjF/index.m3u8";
    EP_URLS[32] = "https://s4.phim1280.tv/20240902/KoJy5F26/index.m3u8";
    EP_URLS[33] = "https://s4.phim1280.tv/20240902/UexGW1KC/index.m3u8";
    EP_URLS[34] = "https://s4.phim1280.tv/20240902/UzcisvC0/index.m3u8";
    EP_URLS[35] = "https://s4.phim1280.tv/20240902/vwmU5Dqr/index.m3u8";
    EP_URLS[36] = "https://s4.phim1280.tv/20240902/q8kWvxP3/index.m3u8";
    EP_URLS[37] = "https://s4.phim1280.tv/20240902/pcV053Zf/index.m3u8";
    EP_URLS[38] = "https://s4.phim1280.tv/20240902/5qYtUXrU/index.m3u8";
    EP_URLS[39] = "https://s4.phim1280.tv/20240902/6MYLKhBA/index.m3u8";
    EP_URLS[40] = "https://s4.phim1280.tv/20240902/3fWNeYaO/index.m3u8";
    EP_URLS[41] = "https://s4.phim1280.tv/20240902/91I83K0q/index.m3u8";
    EP_URLS[42] = "https://s4.phim1280.tv/20240902/s952CEmg/index.m3u8";
    EP_URLS[43] = "https://s4.phim1280.tv/20240902/WPiED4QN/index.m3u8";
    EP_URLS[44] = "https://s4.phim1280.tv/20240902/Qxlr84Rk/index.m3u8";
    EP_URLS[45] = "https://s4.phim1280.tv/20240902/EBPVfPpA/index.m3u8";
    EP_URLS[46] = "https://s4.phim1280.tv/20240902/wz7lSCVI/index.m3u8";
    EP_URLS[47] = "https://s4.phim1280.tv/20240902/q6U5PdGa/index.m3u8";
    EP_URLS[48] = "https://s4.phim1280.tv/20240902/IAoPWvC6/index.m3u8";
    EP_URLS[49] = "https://s4.phim1280.tv/20240902/lf1u1s2u/index.m3u8";
    EP_URLS[50] = "https://s4.phim1280.tv/20240902/A368EtxJ/index.m3u8";
    EP_URLS[51] = "https://s4.phim1280.tv/20240902/Gc31K6ES/index.m3u8";
    EP_URLS[52] = "https://s4.phim1280.tv/20240902/72u6OKhp/index.m3u8";
    EP_URLS[53] = "https://s4.phim1280.tv/20240910/AgnW6jg5/index.m3u8";
    EP_URLS[54] = "https://s4.phim1280.tv/20240916/pQwFfDJh/index.m3u8";
    EP_URLS[55] = "https://s5.phim1280.tv/20240925/ev5LaTe5/index.m3u8";
    EP_URLS[56] = "https://s5.phim1280.tv/20240930/wJyZTmgh/index.m3u8";
    EP_URLS[57] = "https://s5.phim1280.tv/20241008/tZhxIMfd/index.m3u8";
    EP_URLS[58] = "https://s4.phim1280.tv/20241021/AvZ9KDGX/index.m3u8";
    EP_URLS[59] = "https://s4.phim1280.tv/20241021/hbsz3IqB/index.m3u8";
    EP_URLS[60] = "https://s5.phim1280.tv/20241028/C5zAGgfh/index.m3u8";
    EP_URLS[61] = "https://s4.phim1280.tv/20241104/ubgQPtgV/index.m3u8";
    EP_URLS[62] = "https://s5.phim1280.tv/20241112/L2S2UFfL/index.m3u8";
    EP_URLS[63] = "https://s4.phim1280.tv/20241126/xzwaQY40/index.m3u8";
    EP_URLS[64] = "https://s4.phim1280.tv/20241126/ZPy2j4fV/index.m3u8";
    EP_URLS[65] = "https://s4.phim1280.tv/20241209/9sv21U3V/index.m3u8";
    EP_URLS[66] = "https://s4.phim1280.tv/20241209/lHJqyIqQ/index.m3u8";
    EP_URLS[67] = "https://s4.phim1280.tv/20241223/npxPlKjZ/index.m3u8";
    EP_URLS[68] = "https://s4.phim1280.tv/20241223/SfYqeLSI/index.m3u8";
    EP_URLS[69] = "https://s5.phim1280.tv/20241230/vpoQSKuU/index.m3u8";
    EP_URLS[70] = "https://s5.phim1280.tv/20250113/HbYRkB5Q/index.m3u8";
    EP_URLS[71] = "https://s5.phim1280.tv/20250113/TJlfC5Ym/index.m3u8";
    EP_URLS[72] = "https://s5.phim1280.tv/20250121/GsCqvjIJ/index.m3u8";
    EP_URLS[73] = "https://s4.phim1280.tv/20250128/5fmooGLO/index.m3u8";
    EP_URLS[74] = "https://s4.phim1280.tv/20250203/hn7glH9O/index.m3u8";
    EP_URLS[75] = "https://s4.phim1280.tv/20250211/ZGjJUTzf/index.m3u8";
    EP_URLS[76] = "https://s4.phim1280.tv/20250217/FnsyBqiP/index.m3u8";
    EP_URLS[77] = "https://s5.phim1280.tv/20250225/kerZ5vM0/index.m3u8";
    EP_URLS[78] = "https://s4.phim1280.tv/20250307/OI61voPZ/index.m3u8";
    EP_URLS[79] = "https://s4.phim1280.tv/20250310/AzMBuXLM/index.m3u8";
    EP_URLS[80] = "https://s5.phim1280.tv/20250322/ExajaR4u/index.m3u8";
    EP_URLS[81] = "https://s5.phim1280.tv/20250324/BcQQ8wlx/index.m3u8";
    EP_URLS[82] = "https://s4.phim1280.tv/20250401/H4EySjYc/index.m3u8";
    EP_URLS[83] = "https://s5.phim1280.tv/20250407/WHjTD1Bv/index.m3u8";
    EP_URLS[84] = "https://s4.phim1280.tv/20250414/qF3LiXXQ/index.m3u8";
    EP_URLS[85] = "https://s5.phim1280.tv/20250421/h4YYM2VR/index.m3u8";
    EP_URLS[86] = "https://s4.phim1280.tv/20250428/3JFqX7zD/index.m3u8";
    EP_URLS[87] = "https://s5.phim1280.tv/20250505/Zpo48XHh/index.m3u8";
    EP_URLS[88] = "https://s5.phim1280.tv/20250512/Kg5rNTil/index.m3u8";
    EP_URLS[89] = "https://s4.phim1280.tv/20250519/EYnWB7NX/index.m3u8";
    EP_URLS[90] = "https://s6.kkphimplayer6.com/20250525/6VjWTWRK/index.m3u8";
    EP_URLS[91] = "https://s6.kkphimplayer6.com/20250602/2gCXJwTu/index.m3u8";
    EP_URLS[92] = "https://s6.kkphimplayer6.com/20250609/sbhhXwD0/index.m3u8";
    EP_URLS[93] = "https://s6.kkphimplayer6.com/20250616/oPZUpkff/index.m3u8";
    EP_URLS[94] = "https://s6.kkphimplayer6.com/20250625/ZmAN0RVB/index.m3u8";
    EP_URLS[95] = "https://s6.kkphimplayer6.com/20250630/AfuvfaNo/index.m3u8";
    EP_URLS[96] = "https://s6.kkphimplayer6.com/20250707/0cPvATsU/index.m3u8";
    EP_URLS[97] = "https://s6.kkphimplayer6.com/20250713/XWc58Mqq/index.m3u8";
    EP_URLS[98] = "https://s6.kkphimplayer6.com/20250720/9p8psu23/index.m3u8";
    EP_URLS[99] = "https://s6.kkphimplayer6.com/20250728/DwPkieIz/index.m3u8";
    EP_URLS[100]= "https://s6.kkphimplayer6.com/20250805/qRrLo11N/index.m3u8";
    EP_URLS[101]= "https://s6.kkphimplayer6.com/20250811/rIeKyOog/index.m3u8";
    EP_URLS[102]= "https://s6.kkphimplayer6.com/20250819/YHakKU9Y/index.m3u8";
    EP_URLS[103]= "https://s6.kkphimplayer6.com/20250825/v4gxLfJd/index.m3u8";
    EP_URLS[104]= "https://s6.kkphimplayer6.com/20250901/w0afEOVq/index.m3u8";
    EP_URLS[105]= "https://s6.kkphimplayer6.com/20250907/KwVRQ6qF/index.m3u8";
    EP_URLS[106]= "https://s6.kkphimplayer6.com/20250915/q8R2ht6s/index.m3u8";
    EP_URLS[107]= "https://s6.kkphimplayer6.com/20250922/IqSifeBs/index.m3u8";
    EP_URLS[108]= "https://s6.kkphimplayer6.com/20250930/ZIE5kF1t/index.m3u8";
    EP_URLS[109]= "https://s6.kkphimplayer6.com/20251006/Nn9XuTXc/index.m3u8";
    EP_URLS[110]= "https://s6.kkphimplayer6.com/20251013/PyQnpX5Y/index.m3u8";
    EP_URLS[111]= "https://s6.kkphimplayer6.com/20251020/pwGh7FcV/index.m3u8";
    EP_URLS[112]= "https://s6.kkphimplayer6.com/20251103/QgYDekJy/index.m3u8";
    EP_URLS[113]= "https://s6.kkphimplayer6.com/20251103/7kaGY4Az/index.m3u8";
    EP_URLS[114]= "https://s6.kkphimplayer6.com/20251109/Mlw3oaAX/index.m3u8";
    EP_URLS[115]= "https://s6.kkphimplayer6.com/20251116/w3QUN352/index.m3u8";
    EP_URLS[116]= "https://s6.kkphimplayer6.com/20251123/km737TkW/index.m3u8";
    EP_URLS[117]= "https://s6.kkphimplayer6.com/20251130/XNRMqlJF/index.m3u8";
    EP_URLS[118]= "https://s6.kkphimplayer6.com/20251208/Ozq3pc8f/index.m3u8";
    EP_URLS[119]= "https://s6.kkphimplayer6.com/20251215/1LjoFDEH/index.m3u8";
    EP_URLS[120]= "https://s6.kkphimplayer6.com/20251222/x4DDm68O/index.m3u8";
    EP_URLS[121]= "https://s6.kkphimplayer6.com/20251229/B7MuH4x0/index.m3u8";
    EP_URLS[122]= "https://s6.kkphimplayer6.com/20260105/hKA0MbvL/index.m3u8";
    EP_URLS[123]= "https://s6.kkphimplayer6.com/20260112/TXODlCvA/index.m3u8";
    EP_URLS[124]= "https://s6.kkphimplayer6.com/20260119/Za0qyXSD/index.m3u8";
    EP_URLS[125]= "https://s6.kkphimplayer6.com/20260126/yJmCuVRM/index.m3u8";
    // EP_URLS[126] = ""; // em th√™m sau
    // EP_URLS[127] = "";
    // EP_URLS[128] = "";

    // (Tu·ª≥ ch·ªçn) AFF (n·∫øu mu·ªën)
    const AFF_TIKTOK = "https://vt.tiktok.com/ZS91xpNUw7kcD-nRXjG/";
    const AFF_SHOPEE = ""; // em ƒëi·ªÅn sau
// ======================== AFF (APP MOBILE / WEB PC) ========================
// ‚úÖ TikTok link em ƒë∆∞a (universal link) ‚Äî tr√™n mobile th∆∞·ªùng t·ª± b·∫≠t app
const TIKTOK_WEB = "https://vt.tiktok.com/ZS91xpNUw7kcD-nRXjG/";

// ‚úÖ Shopee: em t·ª± ƒëi·ªÅn sau
const SHOPEE_WEB = "";        // v√≠ d·ª•: "https://shopee.vn/....(link aff)"
const SHOPEE_APP = "";        // v√≠ d·ª• deep link app (n·∫øu c√≥): "shopee://..."

function isMobileDevice(){
  return /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
}

// ‚úÖ m·ªü app tr∆∞·ªõc, n·∫øu kh√¥ng ƒë∆∞·ª£c th√¨ fallback sang web
function openMobileWithFallback(appUrl, webUrl){
  const hasWeb = !!(webUrl && webUrl.trim());
  const hasApp = !!(appUrl && appUrl.trim());

  // n·∫øu kh√¥ng c√≥ appUrl th√¨ m·ªü web lu√¥n
  if (!hasApp){
    if (hasWeb) window.location.href = webUrl;
    return;
  }

  // th·ª≠ m·ªü app (ch·ªâ ho·∫°t ƒë·ªông t·ªët khi ƒë∆∞·ª£c g·ªçi t·ª´ click)
  window.location.href = appUrl;

  // fallback sang web sau 900ms n·∫øu app kh√¥ng m·ªü / b·ªã ch·∫∑n
  setTimeout(() => {
    if (hasWeb) window.location.href = webUrl;
  }, 900);
}

function openAFFRandom(){
  // danh s√°ch ngu·ªìn aff (c√≥ th·ªÉ ch·ªâ c√≥ 1 c√°i)
  const sources = [];

  // TikTok: tr√™n mobile c·ª© d√πng WEB link c≈©ng th∆∞·ªùng b·∫≠t app (universal link)
  sources.push({
    name: "tiktok",
    mobileApp: "",            // TikTok kh√¥ng c·∫ßn deep link ri√™ng (ƒë·ªÉ tr·ªëng)
    mobileWeb: TIKTOK_WEB,
    pcWeb: TIKTOK_WEB
  });

  // Shopee: em ƒëi·ªÅn sau
  if (SHOPEE_WEB || SHOPEE_APP){
    sources.push({
      name: "shopee",
      mobileApp: SHOPEE_APP,  // em ƒëi·ªÅn n·∫øu c√≥, kh√¥ng c√≥ th√¨ ƒë·ªÉ ""
      mobileWeb: SHOPEE_WEB,
      pcWeb: SHOPEE_WEB
    });
  }

  if (!sources.length) return;

  const pick = sources[Math.floor(Math.random() * sources.length)];
  const isMobile = isMobileDevice();

  if (isMobile){
    // ∆Øu ti√™n app (n·∫øu c√≥), fallback web
    openMobileWithFallback(pick.mobileApp, pick.mobileWeb || pick.pcWeb);
  } else {
    // PC: m·ªü web (m·ªü tab m·ªõi cho ƒë·ª° m·∫•t trang ƒëang xem)
    const url = pick.pcWeb || pick.mobileWeb;
    if (url) window.open(url, "_blank");
  }
}

    /* ================== UI ================== */
    document.getElementById("movieInfo").textContent = `${MOVIE_TITLE} ‚Ä¢ ${TOTAL_EP} t·∫≠p`;
    document.getElementById("subInfo").textContent = `C·∫≠p nh·∫≠t: t·∫≠p ${UPDATED_EP}/${TOTAL_EP}`;

    const videoEl = document.getElementById("video");
    const iframeBox = document.getElementById("iframeBox");
    const iframeEl = document.getElementById("iframe");
    const nowPlayingEl = document.getElementById("nowPlaying");
    const playerTypeEl = document.getElementById("playerType");

    let hls = null;

    function showModal(title, msg, sub){
      document.getElementById("modalTitle").textContent = title;
      document.getElementById("modalMsg").textContent = msg;
      document.getElementById("modalSub").textContent = sub || "";
      document.getElementById("modalBack").style.display = "flex";
    }
    function hideModal(){
      document.getElementById("modalBack").style.display = "none";
    }
    function scrollToEpisodes(){
      document.getElementById("epGrid").scrollIntoView({behavior:"smooth", block:"start"});
    }

    function getEpList(){
      const arr = Array.from({length: TOTAL_EP}, (_,i) => i+1);

      const q = (document.getElementById("epSearch").value || "").trim();
      let out = arr;
      if (q){
        const n = parseInt(q, 10);
        if (!Number.isNaN(n)) out = arr.filter(x => x === n);
      }

      const mode = document.getElementById("epSort").value;
      if (mode === "desc") out = out.slice().sort((a,b)=>b-a);
      else if (mode === "done"){
        out = out.slice().sort((a,b)=>{
          const da = !!EP_URLS[a];
          const db = !!EP_URLS[b];
          if (da === db) return a-b;
          return db - da;
        });
      }
      return out;
    }

    function renderEpisodes(){
      const grid = document.getElementById("epGrid");
      grid.innerHTML = "";

      const eps = getEpList();
      eps.forEach(ep=>{
        const btn = document.createElement("button");
        btn.className = "epBtn";
        btn.type = "button";
        btn.textContent = String(ep).padStart(2,"0");

        const hasLink = !!EP_URLS[ep];
        if (hasLink) btn.classList.add("done");
        else btn.classList.add("lock");

        const note = document.createElement("small");
        note.textContent = hasLink ? "C√≥ link" : "ƒêang c·∫≠p nh·∫≠t";
        btn.appendChild(note);

        btn.onclick = () => playEpisode(ep);
        grid.appendChild(btn);
      });
    }

    function resetPlayers(){
      // t·∫Øt iframe
      iframeEl.src = "about:blank";
      iframeBox.style.display = "none";

      // t·∫Øt video/hls
      try { videoEl.pause(); } catch(e){}
      videoEl.removeAttribute("src");
      videoEl.load();

      if (hls){
        try { hls.destroy(); } catch(e){}
        hls = null;
      }
    }

    function isM3U8(url){
      return /\.m3u8(\?.*)?$/i.test(url);
    }

    function isProbablyPlayer(url){
      // link d·∫°ng player/iframe (em c√≥ th·ªÉ ch·ªânh th√™m ƒëi·ªÅu ki·ªán n·∫øu mu·ªën)
      return /player|embed|iframe/i.test(url) && !isM3U8(url);
    }

    function playM3U8(url){
      resetPlayers();
      iframeBox.style.display = "none";
      videoEl.style.display = "block";

      // Safari iOS c√≥ th·ªÉ play native HLS
      if (videoEl.canPlayType("application/vnd.apple.mpegurl")){
        videoEl.src = url;
        videoEl.play().catch(()=>{});
        playerTypeEl.textContent = "ƒêang ph√°t: m3u8 (native)";
        return;
      }

      // Chrome/Android/PC d√πng HLS.js
      if (window.Hls && window.Hls.isSupported()){
        hls = new Hls({
          // c·∫•u h√¨nh nh·∫π, gi·∫£m l·ªói timeout
          maxBufferLength: 30,
          backBufferLength: 30
        });
        hls.loadSource(url);
        hls.attachMedia(videoEl);
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
          videoEl.play().catch(()=>{});
        });
        hls.on(Hls.Events.ERROR, (event, data) => {
          // N·∫øu ngu·ªìn ch·∫∑n/cors => b√°o cho user
          if (data && data.fatal){
            showModal("Kh√¥ng ph√°t ƒë∆∞·ª£c", "Ngu·ªìn video c√≥ th·ªÉ ch·∫∑n (CORS/Referer/token).", "Th·ª≠ ƒë·ªïi ngu·ªìn kh√°c ho·∫∑c d√πng link player/iframe.");
          }
        });
        playerTypeEl.textContent = "ƒêang ph√°t: m3u8 (HLS.js)";
        return;
      }

      showModal("Thi·∫øu h·ªó tr·ª£", "Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ ph√°t m3u8.", "Th·ª≠ Safari iPhone ho·∫∑c c·∫≠p nh·∫≠t tr√¨nh duy·ªát.");
    }

    function playIFRAME(url){
      resetPlayers();
      videoEl.style.display = "none";
      iframeBox.style.display = "block";
      iframeEl.src = url;
      playerTypeEl.textContent = "ƒêang ph√°t: player/iframe";
    }

    function playEpisode(ep){
      const url = EP_URLS[ep];

      if (!url){
        showModal(`${MOVIE_TITLE} ‚Äì T·∫≠p ${ep}`, "T·∫≠p n√†y ch∆∞a c√≥ link.", "B·∫°n quay l·∫°i sau nha.");
        return;
      }

      nowPlayingEl.textContent = `${MOVIE_TITLE} ‚Äì T·∫≠p ${String(ep).padStart(2,"0")}`;

      // ‚úÖ ch·ªçn ki·ªÉu ph√°t theo link
      if (isM3U8(url)){
        playM3U8(url);
      } else if (isProbablyPlayer(url)){
        playIFRAME(url);
      } else {
        // fallback: m·ªü tab m·ªõi
        window.open(url, "_blank");
        playerTypeEl.textContent = "M·ªü link ngo√†i (fallback)";
      }

      /* ‚úÖ N·∫øu mu·ªën b·∫≠t AFF random khi b·∫•m t·∫≠p (tu·ª≥ √Ω)
      setTimeout(() => {
        const list = [AFF_TIKTOK, AFF_SHOPEE].filter(Boolean);
        if (list.length){
          const pick = list[Math.floor(Math.random()*list.length)];
          window.location.href = pick;
        }
      }, 1500);
      */
    }

    // events
    document.getElementById("epSearch").addEventListener("input", renderEpisodes);
    document.getElementById("epSort").addEventListener("change", renderEpisodes);

    document.getElementById("closeModal").addEventListener("click", hideModal);
    document.getElementById("modalBack").addEventListener("click", (e)=>{ if(e.target.id==="modalBack") hideModal(); });
    document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") hideModal(); });

    renderEpisodes();
  </script>
</body>
</html>
